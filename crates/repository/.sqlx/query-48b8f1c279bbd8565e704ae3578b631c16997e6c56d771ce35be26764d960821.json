{
  "db_name": "PostgreSQL",
  "query": "WITH new_tags AS (\n    INSERT INTO tags (title, user_id)\n    SELECT\n        unnest($3::text []) AS title, $1 AS user_id\n        ON CONFLICT (user_id, title) DO NOTHING\n        RETURNING id\n),\n\nall_tags AS (\n    SELECT id FROM new_tags\n    UNION ALL\n    SELECT id\n    FROM tags\n    WHERE user_id = $1 AND title = any($3::text [])\n),\n\ndeleted_uft AS (\n    DELETE FROM user_feed_tags uft\n    WHERE\n        uft.user_id = $1\n        AND uft.user_feed_id = $2\n        AND uft.tag_id NOT IN (SELECT id FROM all_tags)\n)\n\nINSERT INTO user_feed_tags (user_feed_id, tag_id, user_id)\nSELECT $2 AS user_feed_id, all_tags.id, $1 AS user_id\nFROM all_tags\nON CONFLICT (user_feed_id, tag_id) DO NOTHING\n",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Uuid",
        "Uuid",
        "TextArray"
      ]
    },
    "nullable": []
  },
  "hash": "48b8f1c279bbd8565e704ae3578b631c16997e6c56d771ce35be26764d960821"
}
